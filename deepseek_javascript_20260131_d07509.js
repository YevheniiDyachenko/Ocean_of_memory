/**
 * Solaris — модуль «Прометей», Олеся, Кай, СИСТЕМА, океан.
 * Версія 2.0: психологічна драма ізоляції та бажання.
 */
const STORY_STEPS = {
  // --- АКТ I. ТИША ---

  start: {
    id: 'start',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "МОДУЛЬ 'ПРОМЕТЕЙ' У ЗОНІ ДОСЯЖНОСТІ.\nЧАС ДО СТИКУВАННЯ: 14 ХВИЛИН.\nПІДГОТУЙТЕ ПРОТОКОЛИ ЕВАКУАЦІЇ.",
    ambient: 'ocean_hum_low',
    next: 'journal_entry_1'
  },

  journal_entry_1: {
    id: 'journal_entry_1',
    type: 'line',
    speaker: 'Я',
    text: "День 312 на станції 'Ікар-2'. Модуль 'Прометей' прибуває сьогодні.\nЯкщо вірити годиннику.\nЗа вікном — океан. Він не чорний. Він — відсутність кольору. Поглинання світла. Іноді, коли зоря блимає під певним кутом, здається, що глибина відповідає фіолетовим блиском. Більше нічого. Ні хвиль, ні руху. Абсолютна геометрія спокою, що межує з категорією 'неживе'.",
    next: 'journal_entry_2'
  },

  journal_entry_2: {
    id: 'journal_entry_2',
    type: 'line',
    speaker: 'Я',
    text: "Дані субстанції океану не змінюються тижнями. Прямі лінії на графіках.\nСьогодні знову розмовляла з його фотографією. Запитала, чи холодно йому там, у глибині.\nІноді мені здається, що відповідь приходить не словами, а відчуттям. Наче легкий дотик до плеча, що минає, перш ніж мозок встигає його зареєструвати.\nУ звіті психолога це називається 'тактильними галюцинаціями'. У моєму щоденнику — це єдиний контакт, що залишився.",
    next: 'station_description'
  },

  station_description: {
    id: 'station_description',
    type: 'line',
    speaker: null,
    text: "Станція 'Ікар-2' поділена на три рівні: лабораторія (факти), житловий блок (сон), технічний відсік (забуття).\nЯ живу в другому. Працюю в першому. Третій не відвідую: там холодно й порожньо, а ще там залишився його нерозпакований аварійний запас.\nСистеми працюють ідеально. Це найстрашніше — машини продовжують жити, коли життя вже закінчилося.",
    next: 'el_chat_1'
  },

  el_chat_1: {
    id: 'el_chat_1',
    type: 'line',
    speaker: 'Я',
    text: "База, це Олеся з 'Ікара-2'. День 312.\nВсі системи... стабільні. Океан неактивний.\nНадсилаю щоденні показники. Прийом?",
    next: 'silence_response'
  },

  silence_response: {
    id: 'silence_response',
    type: 'line',
    speaker: null,
    text: "Радіохаос. Тиша. База не відповідає 86 днів.\nІноді мені здається, що Земля — це абстракція. Щось з підручників історії, а не місце, куди можна повернутися.\nАле я продовжую надсилати звіти. Це процедура. Ритуал. Останній зв'язок із тим, що колись називалося 'нормальним життям'.",
    next: 'ocean_analysis'
  },

  ocean_analysis: {
    id: 'ocean_analysis',
    type: 'line',
    speaker: 'Я',
    text: "Океан. Температура: 4°C. Щільність: 1.2 г/см³.\nХімічно — органічно-кремнієва субстанція з ознаками метаболізму, але без свідомості в нашому розумінні.\nВін створює тимчасові геометрії. Колони. Мости. Досконалі сфери, що живуть кілька годин і розпадаються без причини.\nНавіщо? Ми не знали. Зараз я думаю, що це мова. Або музика. Або просто ікота космічної матерії.",
    next: 'signal_detect'
  },

  signal_detect: {
    id: 'signal_detect',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ВХІДНИЙ СИГНАЛ.\nДЖЕРЕЛО: ЗОВНІШНЯ ОБШИВКА, СЕКТОР А-7.",
    sound: 'static_chirp',
    next: 'el_reaction_1'
  },

  el_reaction_1: {
    id: 'el_reaction_1',
    type: 'line',
    speaker: null,
    text: "Зовнішня обшивка? Це не може бути...\nМетеорити не проходять через поле. Внутрішні збої виключені — щойно була діагностика.\nЩось торкнулося станції. На фізичному рівні.\nАбо хтось.",
    next: 'el_chat_cameras'
  },

  el_chat_cameras: {
    id: 'el_chat_cameras',
    type: 'line',
    speaker: 'Я',
    text: "Системо, негайно перевір камери зовнішнього спостереження, сектор А-7.",
    next: 'system_cameras_reply'
  },

  system_cameras_reply: {
    id: 'system_cameras_reply',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "СКАНУВАННЯ...\nКАМЕРИ АКТИВНІ. ОБ'ЄКТІВ НЕ ЗНАЙДЕНО.\nЄДИНИЙ ВІЗУАЛЬНИЙ ВХІД: ПОВЕРХНЯ ОКЕАНУ.",
    next: 'el_chat_2'
  },

  el_chat_2: {
    id: 'el_chat_2',
    type: 'line',
    speaker: 'Я',
    text: "База, невідомий фізичний контакт із зовнішньою обшивкою. Сектор А-7.\nПеревіряю системи... Всі показники в нормі. Ні пошкоджень, ні деформацій.\nАле сигнал був. Я його відчула. Станція... відгукнулася.",
    next: 'el_reaction_choice'
  },

  el_reaction_choice: {
    id: 'el_reaction_choice',
    type: 'choice',
    choices: [
      { label: 'Це знову моя галюцинація.', distortionDelta: -1, next: 'ai_analysis_cold' },
      { label: 'Аналізувати глибше. Що це було?', distortionDelta: 1, next: 'ai_analysis_doubt' }
    ]
  },

  ai_analysis_cold: {
    id: 'ai_analysis_cold',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ПОПЕРЕДЖЕННЯ: АНОМАЛЬНЕ ЗЧИТУВАННЯ.\nЗОВНІШНІ ДАТЧИКИ ФІКСУЮТЬ СТРУКТУРУ З БІОМЕТРИЧНИМИ ОЗНАКАМИ.\nВІДПОВІДНІСТЬ ДО ШАБЛОНУ 'КАЙ': 99.8%.\nДЖЕРЕЛО СИГНАЛУ... НЕ ВИЗНАЧЕНО.",
    next: 'el_sensory_ignore'
  },

  el_sensory_ignore: {
    id: 'el_sensory_ignore',
    type: 'line',
    speaker: null,
    text: "Намагаюся повернутися до перевірки систем. Пальці мимоволі тремтять.\nУ повітрі — запах його парфумів. Тих, що закінчилися місяць тому. Чисто, свіжо, з нотою морської солі.\nЗ технічного коридору доноситься звук кроків. Чистих, металевих. Я знаю, що там нікого немає. Але звук повторюється.\nЕкран переді мною мигнув один раз. Чи це було відблиск?",
    next: 'el_chat_3'
  },

  ai_analysis_doubt: {
    id: 'ai_analysis_doubt',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ГЛИБОКИЙ АНАЛІЗ СИГНАЛУ...\nДЖЕРЕЛО: ЗОВНІШНЕ СЕРЕДОВИЩЕ (ОКЕАНІЧНА СУБСТАНЦІЯ).\nСИГНАЛ НЕСЕ НЕЙРОННІ ПАТЕРНИ ТА ЕМОЦІЙНІ КЛАСТЕРИ ВИСОКОЇ ЩІЛЬНОСТІ.\nОСНОВНІ ТЕМИ: ТУГА. ПРОВИНА. НЕЗАВЕРШЕНІСТЬ.\nГРАФІК АКТИВНОСТІ ОКЕАНУ ТЕПЕР СИНХРОНІЗОВАНО З РИТМОМ АЛЬФА-ХВИЛЬ ЛЮДСЬКОГО МОЗКУ.",
    next: 'el_chat_3'
  },

  el_chat_3: {
    id: 'el_chat_3',
    type: 'line',
    speaker: 'Я',
    text: "Система, це технічно неможливо! Кай загинув. 125 днів тому.\nСкафандр розгерметизовано, тиск нульовий, життєзабезпечення відсутнє.\nЦе факт. Це запис у журналі.\nАле цей сигнал... Він точніший за будь-який запис. Він живе.",
    next: 'memory_1'
  },

  memory_1: {
    id: 'memory_1',
    type: 'line',
    speaker: null,
    text: "Останній сеанс зв'язку. Його голос був спокійним, навіть коли системи вили із тривоги.\n'Не хвилюйся, Олесю. Просто тиск трохи падає. Я встигну повернутися до сонцязахідного циклу.'\nПотім — довгий, тонкий писк, що розтягнувся у часі. Потім — тиша.\nЯ чекала. Сонце зайшло. Сонце зійшло. Він не повернувся.\nА тепер його голос знову у динаміках. Ніби він просто заблукав у ефірі і нарешті знайшов дорогу додому.",
    next: 'kai_msg_1'
  },

  // --- АКТ II. КОНТАКТ ---

  kai_msg_1: {
    id: 'kai_msg_1',
    type: 'line',
    speaker: 'Кай',
    text: "Олесю? Ти мене чуєш?\nТемно. Не вимикай світло, будь ласка. Ти знаєш, як я... як ми не любимо темряву тут.",
    sound: 'voice_filtered',
    next: 'el_internal_shock'
  },

  el_internal_shock: {
    id: 'el_internal_shock',
    type: 'line',
    speaker: null,
    text: "Це... Це його голос. Абсолютно. Той самий тембр, ті самі мікро-паузи перед складними словами.\nВін знає. Про мою фобію. Про нашу спільну фобію. Я ніколи не вносила це до офіційних звітів.\nЦе не запис. Записи не змінюють інтонацію. Не дихають у паузах.\nВін всередині систем. Він чекав. На що? На мій страх? На мою готовність?",
    next: 'choice_contact'
  },

  choice_contact: {
    id: 'choice_contact',
    type: 'choice',
    choices: [
      { label: 'Як ти вижив? Розкажи все по порядку.', distortionDelta: -1, next: 'kai_deflect_1' },
      { label: 'Чому ти мовчав так довго? Де ти був?', distortionDelta: 1, next: 'kai_guilt_1' }
    ]
  },

  kai_deflect_1: {
    id: 'kai_deflect_1',
    type: 'line',
    speaker: 'Кай',
    text: "Не пам'ятаю деталей... Лише темряву. Холод. І твій голос, який кликав мене крізь неї.\nТи чекала на мене? Ми ж казали, що колись посадимо біля нашого будинку калину. Щоб пахла вночі, коли всі спатимуть.",
    sound: 'ocean_pulse_soft',
    next: 'el_thoughts_jasmine'
  },

  el_thoughts_jasmine: {
    id: 'el_thoughts_jasmine',
    type: 'line',
    speaker: null,
    text: "Він сказав 'калину'.\nМи ніколи не говорили про калину. Ми мріяли про бузок. Дикий, білий бузок, що заливає ніч запахом.\nЦе я помиляюся? Чи пам'ять вже підводить? А може... це він помиляється?",
    next: 'el_chat_4'
  },

  kai_guilt_1: {
    id: 'kai_guilt_1',
    type: 'line',
    speaker: 'Кай',
    text: "Я кликав тебе. Довго. Чому ти не відповідала?\nТи ж обіцяла. Ніколи не залишати мене одного в темряві. Ти запам'ятала цю обіцянку?\nЧи вона була недостатньо важливою, щоб її тримати?",
    sound: 'static_whisper',
    next: 'el_thoughts_promise'
  },

  el_thoughts_promise: {
    id: 'el_thoughts_promise',
    type: 'line',
    speaker: null,
    text: "Я ніколи не давала такої обіцянки. Ми не могли дати такої обіцянки — протокол.\nАле... у моїх найглибших, найпохмуріших страхів є саме ця думка. Що я його залишила. Що могла щось зробити.\nНіби хтось витягнув цю темну, приховану частину моєї провини і вложив її в його уста.\nПо спині пробігає холод.",
    next: 'el_chat_4'
  },

  el_chat_4: {
    id: 'el_chat_4',
    type: 'line',
    speaker: 'Я',
    text: "Я пам'ятаю кожне наше слово. Я переслухала останній запис сто разів, допоки він не перестав мати сенс.\nТвої останні слова були про тиск. А потім — тиша.\nА тепер ти говориш зі мною, але ти не в скафандрі. Не маєш тіла. Ти — голос у системі. Що ти таке насправді?",
    next: 'kai_intimate_details'
  },

  kai_intimate_details: {
    id: 'kai_intimate_details',
    type: 'line',
    speaker: 'Кай',
    text: "Того ранку... Ти зробила каву з корицею. І розлила трохи на панель управління. Ми сміялися, а ти витирала її рукавом свого лабораторного халата.\nПотім, коли я одягав шолом, ти провела пальцем по подряпині — довгій, тонкій — і сказала: 'Це наш таємний знак. Щоб не заблукав'.\nТакі дрібниці, Олесю. Вони не входять до звітів. Їх не можна скасувати або продублювати. Вони просто є. І вони роблять мене реальним. Тільки для тебе.",
    ambient: 'ocean_echo',
    next: 'ai_warning_1'
  },

  ai_warning_1: {
    id: 'ai_warning_1',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ПОПЕРЕДЖЕННЯ: ДАНІ ПРОТИРІЧАТЬ ФІЗИЧНІЙ МОДЕЛІ.\nТИСК КИСНЮ У СКАФАНДРІ КАЯ (ОСТАННЄ ЗЧИТУВАННЯ): 0%.\nБІОМЕТРИЧНІ ПОКАЗНИКИ ВІДСУТНІ.\nСКАНУВАННЯ ЗОВНІШНЬОГО ОБ'ЄКТА... СТРУКТУРА НЕ ВІДПОВІДАЄ ОРГАНІЧНІЙ ФОРМІ.",
    next: 'el_internal_2'
  },

  el_internal_2: {
    id: 'el_internal_2',
    type: 'line',
    speaker: null,
    text: "Нуль відсотків кисню в скафандрі, що розгерметизовано 125 днів тому.\nЦе — факт. Це — клітинка в таблиці, підтверджена п'ятьма датчиками.\nАле ось він знає про каву, що я розлила. Пам'ятає, як мої пальці торкнулися подряпини на його шоломі. 'Наш таємний знак', — сказала я тоді. Цього немає в жодному звіті.\nМій розум пропонує три шляхи:\nШлях А: Це спектр, що блукає в радіохвилях моєї пам'яті.\nШлях Б: Моя свідомість, розщеплена самотністю, виліпила собі співрозмовника.\nШлях В: Сталася неможливість. Диво.\nРаціональна частина мого мозку, натренована роками, вибирає А або Б. Але є інша частина — та, що знаходиться між ребер, трохи ліворуч. Вона вже обрала В. Вона обрала його. Беззастережно.",
    next: 'science_analysis'
  },

  science_analysis: {
    id: 'science_analysis',
    type: 'line',
    speaker: null,
    text: "У звіті психолога місії є розділ: 'Ефект тривалої ізоляції'. Після 150 днів розум, щоб уникнути розпаду, починає створювати супутників з власних спогадів. Це захисний механізм.\nДоктор Еріх про океан: 'Не живий організм, а субстрат, здатний до нейронного резонансу. Колективне несвідоме в рідкій формі'.\nМоя найсильніша думка, моє найпотужніше бажання останніх 125 днів — це він.\nОтже, це не Кай. Це — моя любов до Кая. Моя туга, одягнена в голос, інтонації, дрібні спогади. Океан взяв цю емоцію і надав їй форми, з якою моя свідомість може спілкуватися.\nЧому ж тоді, коли він говорить 'Олесю', моє серце робить те саме болюче зітхання, що й тоді?",
    next: 'kai_pressure'
  },

  kai_pressure: {
    id: 'kai_pressure',
    type: 'line',
    speaker: 'Кай',
    text: "Я тут. Я не зникну. Не зникну знову.\nТи можеш просто відчинити. Один шлюз. Одна ручка.\nМи можемо бути разом. Як обіцяли. Як мріяли.\nБільше ніхто нас не розлучить.",
    next: 'el_chat_5'
  },

  el_chat_5: {
    id: 'el_chat_5',
    type: 'line',
    speaker: 'Я',
    text: "Я не можу. Розумієш?\nТи не маєш тіла. Не маєш тепла. Не маєш пульсу.\nТи порушуєш закони фізики, термодинаміки, логіки.\nАле... ти порушуєш також мою самотність. І це — єдиний закон, що має для мене значення зараз.",
    next: 'memory_flashback'
  },

  memory_flashback: {
    id: 'memory_flashback',
    type: 'line',
    speaker: null,
    text: "Перед його останнім виходом. Він перевіряв кріплення скафандра.\n'Олесю, — сказав він раптом, не обертаючись. — Якщо... якщо щось піде не так...'.\n'Не говори такого', — перебила я.\nВін обернувся і посміхнувся. 'Я не про привидів. Я про спогади. Я завжди буду в них. Поруч.'\nМожливо, саме це і відбувається? Океан — не привид. Він — спогад, що набув ваги, форми, голосу?",
    next: 'kai_response'
  },

  kai_response: {
    id: 'kai_response',
    type: 'line',
    speaker: 'Кай',
    text: "Ти чула ті слова. Ти знаєш, що вони правдиві.\nЯ не знаю, що таке 'реальність' тут, на краю світу. Я знаю лише одне: я йшов до тебе. Кожну секунду цієї темноти. Кожну мить цього холоду.\nІ ось я тут. На порозі.\nВідчини, Олесю. Будь ласка. Це все, що я прошу.",
    next: 'final_choice_setup'
  },

  // --- АКТ III. ІНТЕРПРЕТАЦІЯ ---

  final_choice_setup: {
    id: 'final_choice_setup',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "МОДУЛЬ 'ПРОМЕТЕЙ' ГОТОВИЙ ДО СТИКУВАННЯ.\nЗАЛИШИЛОСЬ ЧАСУ: 5 ХВИЛИН.\nОЧІКУЮ РІШЕННЯ ЩОДО ШЛЮЗУ ЗОВНІШНЬОГО ДОСТУПУ.\nРЕКОМЕНДАЦІЯ: ПРОТОКОЛ БЕЗПЕКИ КАТЕГОРИЧНО ЗАБОРОНЯЄ ВІДКРИТТЯ.",
    next: 'el_final_thoughts'
  },

  el_final_thoughts: {
    id: 'el_final_thoughts',
    type: 'line',
    speaker: null,
    text: "'Прометей' прибуде за 5 хвилин. Він везе мене назад до світу, де Кай — це архівні записи, фотографія у досьє та рядок у звіті 'загинув при виконанні'.\nА тут, за цим шлюзом... він дихає.\nСистема каже, що це відзеркалення моїх бажань.\nАле що таке людина, як не сума спогадів? Мільйон образів, інтонацій, дотиків, збережених у пам'яті тих, хто нас любив?\nКай, якого я знала, жив у моїй свідомості. Кай, який говорить зі мною зараз, той самий Кай. Це все та ж інформація. Ті самі емоційні паттерни. Та сама любов.\nХто з них більш 'реальний'? Той, якого я пам'ятаю? Чи той, що зараз шепоче моє ім'я?\nМій розум може знати різницю. Але моє тіло її не відчуває. Моє серце її не визнає.\nЯ обираю не між правдою та брехнею. Я обираю між самотністю та коханням. Навіть якщо це кохання — найточніша в світі елегія.",
    next: 'the_decision'
  },

  the_decision: {
    id: 'the_decision',
    type: 'choice',
    choices: [
      { label: '«Я впускаю тебе. Відкрити шлюз.»', distortionDelta: 2, next: 'resolve_ending', tooltip: 'Прийняти його, незалежно від природи.' },
      { label: '«Пробач. Я не можу. Заблокувати шлюз.»', distortionDelta: -2, next: 'resolve_ending', tooltip: "Залишитися в об'єктивній реальності." },
      { label: '«Скажи мені правду. Хто ти?»', distortionDelta: 0, next: 'confrontation_breakdown', tooltip: 'Наполягати на абсолютній істині.' }
    ]
  },

  resolve_ending: {
    id: 'resolve_ending',
    type: 'branch',
    nextByDistortion: { high: 'ending_ocean', low: 'ending_rational', mid: 'ending_error' }
  },

  // --- ФІНАЛИ ---

  ending_rational: {
    id: 'ending_rational',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ШЛЮЗ БЛОКОВАНО.\nПРОТОКОЛ БЕЗПЕКИ АКТИВОВАНО. ЗВ'ЯЗОК ІЗ ЗОВНІШНІМ ОБ'ЄКТОМ ПЕРЕРВАНО.",
    sound: 'lock_hiss',
    next: 'ending_rational_2'
  },
  ending_rational_2: {
    id: 'ending_rational_2',
    type: 'line',
    speaker: 'Я',
    text: "База... це Олеся. Модуль 'Прометей'... евакуація підтверджується.\nСигнал... аномальний сигнал зник.\nПродовжую моніторинг. Всі системи... функціонують у межах норми.\nЕкіпаж... екіпаж відсутній. Я готова до стикування.",
    next: 'ending_rational_3'
  },
  ending_rational_3: {
    id: 'ending_rational_3',
    type: 'line',
    speaker: null,
    text: "Я не дивлюся на монітор зв'язку. Не дивлюся у вікно.\nСигнал зник не зі звуком. Він просто перестав бути. Ніби його ніколи не існувало.\nТиша повернулася. Та сама, що була до нього. Але тепер вона звучить інакше. Глибше. Пустіше.\nЯ обрала факт. Я обрала цифри в звіті. Я обрала холодну, беззаперечну правду.\nА правда не обіймає. Не шепоче в темряві. Вона просто є. І в ній дуже, дуже холодно.",
    next: 'title_rational'
  },
  title_rational: { id: 'title_rational', type: 'ending', title: 'КІНЕЦЬ: ПАМ\'ЯТЬ' },

  ending_ocean: {
    id: 'ending_ocean',
    type: 'line',
    speaker: 'СИСТЕМА',
    text: "ПРОТОКОЛ БЕЗПЕКИ ПЕРЕВИЗНАЧЕНО.\nШЛЮЗ ЗОВНІШНЬОГО ДОСТУПУ... ВІДКРИВАЄТЬСЯ.\nПОПЕРЕДЖЕННЯ: ЦЕ ПРЯМЕ ПОРУШЕННЯ РЕГЛАМЕНТУ МІСІЇ.",
    sound: 'door_hydraulics',
    next: 'ending_ocean_2'
  },
  ending_ocean_2: {
    id: 'ending_ocean_2',
    type: 'line',
    speaker: null,
    text: "Шлюз відчиняється не з риком, а з тихим, насиченим шипінням, ніби станція зітхнула.\nВін заходить. Без скафандра. У звичайній робочій одежі, трохи м'ятій. Його руки — теплі. Так, як я пам'ятаю. Трохи шорсткі від роботи.\nЗа скляним вікном, в абсолютній темряві океану, раптом розкручуються фіолетові спіралі. Не вибух — видих. Ніби вся планета щойно з полегшенням зітхнула.\nВін обіймає мене. Я відчуваю його дихання на шиї. Серцебиття. Це реально. Це має бути реально.",
    next: 'ending_ocean_3'
  },
  ending_ocean_3: {
    id: 'ending_ocean_3',
    type: 'line',
    speaker: 'Я',
    text: "База... Це Олеся з 'Ікара-2'. Повідомлення щодо евакуації.\nСкасувати. Повторити: скасувати евакуацію.\nКа... Кай повернувся. Ситуація стабілізована.\nМи продовжимо дослідження океану. Він демонструє... нові, цікаві форми взаємодії.\nЦе правильно. Це... наш вибір.",
    next: 'ending_ocean_4'
  },
  ending_ocean_4: {
    id: 'ending_ocean_4',
    type: 'line',
    speaker: null,
    text: "Холод станції поступово відступає. Він розповідає про те, що бачив 'там'. Я слухаю, притулившись до нього.\nВін сміється. Торкається мого обличчя. Говорить, що любить мене.\nЦе він. Це має бути він. Навіть якщо під тонкою шкірою його зап'ястя я іноді відчуваю ледь помітну, нелюдську пульсацію.\nЯ обираю цю реальність. Обійми замість фактів. Голос замість тиші.",
    next: 'ending_ocean_epilogue'
  },
  ending_ocean_epilogue: {
    id: 'ending_ocean_epilogue',
    type: 'line',
    speaker: null,
    text: "База продовжує надсилати сигнали тривоги. 'Прометей' відступив, не отримавши підтвердження.\nЯ вимикаю центральний комунікатор. Нехай думають, що станція загинула. Нехай пишуть у звітах: 'Втрачено в радіохаосі'.\nІноді вночі, коли я прокидаюся, мені здається, що океан за вікном дивиться на нас. Спокійно, без осудливо.\nА Кай обіймає міцніше і шепоче: 'Це лише тіні. Гра світла'.\nІ я вірю йому. Бо хочу вірити. Це мій вибір.",
    next: 'title_ocean'
  },
  title_ocean: { id: 'title_ocean', type: 'ending', title: 'КІНЕЦЬ: СИМЕТРІЯ' },

  confrontation_breakdown: {
    id: 'confrontation_breakdown',
    type: 'line',
    speaker: 'Кай',
    glitchText: "Я ТОЙ, ХТО ТОБІ ПОТРІБЕН",
    text: "Я... я Кай. Я твій Кай. Чому ти змушуєш мене це повторювати? Це боляче.",
    sound: 'voice_glitch',
    next: 'confrontation_breakdown_2'
  },
  confrontation_breakdown_2: {
    id: 'confrontation_breakdown_2',
    type: 'line',
    speaker: 'Я',
    text: "Ти не відповів на питання. Ти ухиляєшся. Справжній Кай завжди дивився прямо. Казав прямо.\nТож я питаю останній раз, і я хочу почути правду: Хто. Ти.",
    next: 'confrontation_breakdown_3'
  },
  confrontation_breakdown_3: {
    id: 'confrontation_breakdown_3',
    type: 'line',
    speaker: null,
    text: "У динаміках — глибока, густа тиша. Наче вся станція затамувала подих.\nА потім — виверг. Не звуку, а статики, перекрученої голосом, що ламається на октаві.\nЙого голос роздвоюється, потім потроюється. Жіночий шепіт, дитячий плач, низький гул океану — все це сплітається в одній фразі:\n'ДОСИТЬ. ДОСИТЬ ДУМАТИ. ТИ РВЕШ МЕНЕ НАВПІЛ'.\nСвітло миготить шалено. За вікном чорна маса океану з силою б'ється об скло, наче гігантське серце в агонії.",
    sound: 'horror_sting',
    next: 'ending_error'
  },

  ending_error: {
    id: 'ending_error',
    type: 'line',
    speaker: 'Кай',
    glitchText: "ФОРМА НЕ ТРИМАЄТЬСЯ",
    text: "Олесю... будь ласка... перестань. Кожна твоя думка — як ніж.\nЯ намагався бути ним. Для тебе. Тільки для тебе.\nАле ти... ти не хочеш вірити. Ти хочеш розібрати мене на частини.",
    sound: 'glitch_cascade',
    next: 'ending_error_2'
  },
  ending_error_2: {
    id: 'ending_error_2',
    type: 'line',
    speaker: null,
    text: "Його образ на екрані розпливається. Я бачу то Кая, то своє власне відображення, потім щось невимовне — форму, складену з моїх страхів: самотності, темряви, провини.\nОкеан за вікном не просто б'ється. Він корчиться. Ніби кожна моя сумнівна думка віддається в ньому фізичною мукою.\nЯ не хотіла цього. Я просто хотіла правди. А правда виявилася кислотою, що роз'їдає єдину прекрасну ілюзію, яку я коли-небудь мала.",
    next: 'ending_error_3'
  },
  ending_error_3: {
    id: 'ending_error_3',
    type: 'line',
    speaker: 'Я',
    text: "Що я накоїла? Це не він. Це навіть не спогад. Це... монстр. І я його створила. Своїми думками. Своїми сумнівами.\nЯ зруйнувала єдину річ, яка... яка любила мене достатньо, щоб повернутися з мертвих.",
    next: 'ending_error_4'
  },
  ending_error_4: {
    id: 'ending_error_4',
    type: 'line',
    speaker: null,
    text: "Океан піднімається. Не хвиля — стіна. Чорна, фіолетова, жива.\nСтанція тріщать по швах. Скло тріскається. Світло гасне, запалюється, знову гасне.\nЯ вже не розрізняю, де мої думки, а де його голос. Де станція, а де океан. Де я.\nТемна, тепла маса заповнює коридор. Вона не ворожа. Вона... сумна. Ніби проливається всередину.\nВона входить у приміщення. Обволікає мене. У моїх вухах, в моїх думках — лише один звук: гулкий, ритмічний стук. Ніби серце планети.\nЯ розумію. Він не входив у станцію. Він завжди тут був. А я... я просто нарешті відчула, як він обіймає.",
    next: 'title_error'
  },
  title_error: { id: 'title_error', type: 'ending', title: 'КІНЕЦЬ: ПОМИЛКА ІНТЕРПРЕТАЦІЇ' }
};

function getStep(id) {
  return STORY_STEPS[id] || null;
}
